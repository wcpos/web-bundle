__d((function(g,_r,_i,_a,m,_e,d){var e=_r(d[0]);Object.defineProperty(_e,"__esModule",{value:!0}),_e.default=void 0;!(function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=p(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var u=a?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=e[o]}n.default=e,r&&r.set(e,n)})(_r(d[1]));var t=_r(d[2]),r=e(_r(d[3])),n=e(_r(d[4])),a=_r(d[5]),o=_r(d[6]);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(p=function(e){return e?r:t})(e)}const u=(0,t.createStackNavigator)();_e.default=()=>{const{isWebApp:e}=(0,a.useAppState)();if(e)throw new Error('Database error, please reload the app');return(0,o.jsxs)(u.Navigator,{screenOptions:{headerShown:!1},children:[(0,o.jsx)(u.Screen,{name:"Connect",component:r.default}),(0,o.jsx)(u.Screen,{name:"Login",component:n.default,options:{presentation:'transparentModal'}})]})}}),3711,[1,17,2097,3914,3923,1168,483]);
__d((function(g,_r,_i,_a,m,_e,d){var e=_r(d[0]);Object.defineProperty(_e,"__esModule",{value:!0}),_e.default=void 0;!(function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=h(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var s=l?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n)})(_r(d[1]));var t=e(_r(d[2])),r=e(_r(d[3])),n=_r(d[4]),l=_r(d[5]),a=_r(d[6]),s=_r(d[7]),u=_r(d[8]),i=_r(d[9]),f=e(_r(d[10])),o=_r(d[11]),c=e(_r(d[12])),p=_r(d[13]),j=(e(_r(d[14])),_r(d[15]));function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(h=function(e){return e?r:t})(e)}_e.default=()=>{const{user:e}=(0,p.useAppState)();return(0,j.jsx)(t.default,{behavior:'height',style:[{flex:1},r.default.absoluteFill],children:(0,j.jsx)(n.Box,{className:"min-h-screen w-full justify-center items-center",children:(0,j.jsxs)(i.VStack,{space:"lg",className:"w-full max-w-[460px] items-center",children:[(0,j.jsx)(s.Logo,{width:120,height:120}),(0,j.jsx)(l.Card,{className:"p-4 w-full",children:(0,j.jsx)(c.default,{})}),(0,j.jsx)(a.ErrorBoundary,{children:(0,j.jsx)(u.Suspense,{children:(0,j.jsx)(o.Sites,{user:e})})}),(0,j.jsx)(f.default,{})]})})})}}),3914,[1,17,437,30,2220,2389,888,2158,2155,1130,3915,3917,3921,1168,3922,483]);
__d((function(g,_r,_i,_a,m,_e,d){var e=_r(d[0]);Object.defineProperty(_e,"__esModule",{value:!0}),_e.default=void 0;var t=(function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var u=o?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n})(_r(d[1])),r=_r(d[2]),n=_r(d[3]),o=_r(d[4]),a=e(_r(d[5])),u=e(_r(d[6])),s=_r(d[7]),i=e(_r(d[8])),c=_r(d[9]);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}_e.default=()=>{const{onConnect:e}=(0,i.default)(),l=(0,a.default)(),[f,p]=t.useState(!1),w=(0,s.useT)();return(0,c.jsx)(r.Button,{onPress:async()=>{p(!0);try{const t=await e('https://demo.wcpos.com');if(!t)throw new Error('Could not connect to demo site');const{data:r}=await l.get('https://demo.wcpos.com/wp-json/wcpos/v1/jwt/authorize?user=demo');t.incrementalUpdate({$push:{wp_credentials:r}})}catch(e){u.default.error(e)}finally{p(!1)}},disabled:f,variant:"muted",size:"sm",rightIcon:f?(0,c.jsx)(o.Loader,{variant:"muted",size:"xs"}):(0,c.jsx)(n.Icon,{variant:"muted",size:"xs",name:"arrowRight"}),children:(0,c.jsx)(r.ButtonText,{children:w('Enter Demo Store',{_tags:'core'})})})}}),3915,[1,17,1167,898,1099,2309,1767,2083,3916,483]);
__d((function(g,_r,_i,_a,m,_e,d){var e=_r(d[0]);Object.defineProperty(_e,"__esModule",{value:!0}),_e.default=void 0;var t=(function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=u(t);if(r&&r.has(e))return r.get(e);var o={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&{}.hasOwnProperty.call(e,s)){var n=a?Object.getOwnPropertyDescriptor(e,s):null;n&&(n.get||n.set)?Object.defineProperty(o,s,n):o[s]=e[s]}return o.default=e,r&&r.set(e,o),o})(_r(d[1])),r=e(_r(d[2])),o=e(_r(d[3])),a=_r(d[4]),s=_r(d[5]),n=_r(d[6]);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(u=function(e){return e?r:t})(e)}_e.default=()=>{const{user:e,userDB:u}=(0,a.useAppState)(),[c,i]=t.useState(!1),[f,l]=t.useState(!1),p=(0,o.default)(),w=(0,s.useT)(),_=t.useCallback((async e=>{const t=await p.get(e,{params:{wcpos:1}}),o=(0,r.default)(t,'data');if(!o||'object'!=typeof o)throw Error(w('Bad API response',{_tags:'core'}));const a=(0,r.default)(o,'namespaces');if(!a)throw Error(w('WordPress API not found',{_tags:'core'}));if(!a.includes('wc/v3'))throw Error(w('WooCommerce API not found',{_tags:'core'}));if(!a.includes('wcpos/v1'))throw Error(w('WooCommerce POS API not found',{_tags:'core'}));return Object.assign({},o,{wp_api_url:e,wc_api_url:`${e}wc/v3`,wc_api_auth_url:`${e}wcpos/v1/jwt`})}),[p,w]),h=t.useCallback((async e=>{const t=e.replace(/^.*:\/{2,}|\s|\/+$/g,'')||'',o=await p.head(`https://${t}`);if(!o)throw Error(w('URL not found',{_tags:'core'}));const a=(0,r.default)(o,['headers','link']);if(!a)throw Error(w('Link header is not exposed',{_tags:'core'}));const s=(0,n.parseLinkHeader)(a);return(0,r.default)(s,['https://api.w.org/','url'])}),[p,w]);return{onConnect:t.useCallback((async t=>{if(''!==t){i(!0);try{const r=await h(t);if(!r)throw Error(w('Site does not seem to be a WordPress site',{_tags:'core'}));const o=await _(r),a=u.sites.parseRestResponse(o);return await e.incrementalUpdate({$push:{sites:a}}),await u.sites.findOneFix(o.uuid).exec()}catch(e){l(e.message)}finally{i(!1)}}}),[_,h,w,e,u.sites]),loading:c,error:f}}}),3916,[1,17,899,2309,1168,2083,2164]);
__d((function(g,_r,_i,_a,m,_e,d){Object.defineProperty(_e,"__esModule",{value:!0}),_e.Sites=void 0;!(function(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var a=u?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}n.default=e,t&&t.set(e,n)})(_r(d[0]));var e=_r(d[1]),r=_r(d[2]),t=_r(d[3]),n=_r(d[4]),u=_r(d[5]);function o(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(o=function(e){return e?t:r})(e)}_e.Sites=({user:o})=>{const i=(0,e.useObservableSuspense)(o.populateResource('sites'));return i&&0!==i.length?(0,u.jsx)(r.Card,{className:"w-full",children:i.map(((e,r)=>(0,u.jsx)(t.ErrorBoundary,{children:(0,u.jsx)(n.Site,{user:o,site:e,idx:r})},e.uuid)))}):null}}),3917,[17,1170,2389,888,3918,483]);
__d((function(g,_r,_i,_a,m,_e,d){var e=_r(d[0]);Object.defineProperty(_e,"__esModule",{value:!0}),_e.Site=void 0;var r=(function(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var s=y(r);if(s&&s.has(e))return s.get(e);var t={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var o=n?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(t,a,o):t[a]=e[a]}return t.default=e,s&&s.set(e,t),t})(_r(d[1])),s=e(_r(d[2])),t=_r(d[3]),n=_r(d[4]),a=_r(d[5]),o=_r(d[6]),i=_r(d[7]),c=_r(d[8]),l=_r(d[9]),u=_r(d[10]),p=_r(d[11]),x=_r(d[12]),h=_r(d[13]),j=e(_r(d[14])),f=_r(d[15]),v=_r(d[16]),_=_r(d[17]),w=_r(d[18]);function y(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,s=new WeakMap;return(y=function(e){return e?s:r})(e)}_e.Site=({user:e,site:y,idx:P})=>{const[b,A]=r.useState(!1),D=(0,v.useT)(),{wcposVersionPass:k}=(0,_.useVersionCheck)({site:y}),O=(0,j.default)();r.useEffect((()=>{(async()=>{const e=await O.get(y.wp_api_url,{params:{wcpos:1}}),r=(0,s.default)(e,'data',{});y.incrementalPatch({wp_version:r?.wp_version,wc_version:r?.wc_version,wcpos_version:r?.wcpos_version,wcpos_pro_version:r?.wcpos_pro_version,license:r?.license||{}})})()}),[]);const T=r.useCallback((async()=>{try{const r=y.getLatest();await r.remove(),await e.incrementalUpdate({$pullAll:{sites:[r.uuid]}})}catch(e){throw e}}),[y,e]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(o.HStack,{space:"lg",className:(0,l.cn)('p-4',0!==P&&'border-border border-t'),children:[(0,w.jsx)(n.Avatar,{source:`https://icon.horse/icon/${C=y.url,C?.replace(/^.*:\/{2,}|\s|\/+$/g,'')||''}`,className:"w-10 h-10"}),(0,w.jsxs)(h.VStack,{className:"flex-1",children:[(0,w.jsxs)(h.VStack,{space:"xs",children:[(0,w.jsx)(p.Text,{className:"font-bold",children:y.name}),(0,w.jsx)(p.Text,{className:"text-sm",children:y.url})]}),k?(0,w.jsx)(a.ErrorBoundary,{children:(0,w.jsx)(u.Suspense,{children:(0,w.jsx)(f.WPUsers,{site:y})})}):(0,w.jsxs)(o.HStack,{children:[(0,w.jsx)(i.Icon,{name:"triangleExclamation",className:"fill-warning"}),(0,w.jsx)(p.Text,{className:"text-warning",children:D('Please update your WooCommerce POS plugin')})]})]}),(0,w.jsxs)(x.Tooltip,{children:[(0,w.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,w.jsx)(c.IconButton,{name:"circleXmark",size:"lg",variant:"destructive",onPress:()=>A(!0)})}),(0,w.jsx)(x.TooltipContent,{children:(0,w.jsx)(p.Text,{children:D('Remove site',{_tags:'core'})})})]})]}),(0,w.jsx)(t.AlertDialog,{open:b,onOpenChange:A,children:(0,w.jsxs)(t.AlertDialogContent,{children:[(0,w.jsxs)(t.AlertDialogHeader,{children:[(0,w.jsx)(t.AlertDialogTitle,{children:D('Remove site',{_tags:'core'})}),(0,w.jsx)(t.AlertDialogDescription,{children:D('Remove store and associated users?',{_tags:'core'})})]}),(0,w.jsxs)(t.AlertDialogFooter,{children:[(0,w.jsx)(t.AlertDialogCancel,{children:D('Cancel',{_tags:'core'})}),(0,w.jsx)(t.AlertDialogAction,{variant:"destructive",onPress:T,children:D('Remove',{_tags:'core'})})]})]})})]});var C}}),3918,[1,17,899,3576,3429,888,891,898,1102,894,2155,1100,1103,1130,2309,3919,2083,3530,483]);
__d((function(g,_r,_i,_a,m,_e,d){var e=_r(d[0]);Object.defineProperty(_e,"__esModule",{value:!0}),_e.WPUsers=void 0;!(function(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=j(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var o=s?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}n.default=e,t&&t.set(e,n)})(_r(d[1]));var r=_r(d[2]),t=_r(d[3]),n=_r(d[4]),s=_r(d[5]),i=_r(d[6]),o=_r(d[7]),u=_r(d[8]),a=_r(d[9]),l=_r(d[10]),c=e(_r(d[11])),p=_r(d[12]),f=_r(d[13]);function j(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(j=function(e){return e?t:r})(e)}_e.WPUsers=({site:e})=>{const j=(0,t.useObservableSuspense)(e.populateResource('wp_credentials')),x=(0,r.useNavigation)(),_=(0,p.useT)();return(0,f.jsxs)(l.VStack,{space:"xs",children:[(0,f.jsxs)(u.Text,{className:"text-sm",children:[_('Logged in users',{_tags:'core'}),":"]}),(0,f.jsxs)(s.HStack,{children:[j.map((r=>(0,f.jsx)(n.ErrorBoundary,{children:(0,f.jsx)(o.Suspense,{children:(0,f.jsx)(c.default,{wpUser:r,site:e})})},r.uuid))),(0,f.jsxs)(a.Tooltip,{children:[(0,f.jsx)(a.TooltipTrigger,{asChild:!0,children:(0,f.jsx)(i.IconButton,{name:"circlePlus",size:"lg",onPress:()=>x.navigate('Login',{siteID:e.uuid})})}),(0,f.jsx)(a.TooltipContent,{children:(0,f.jsx)(u.Text,{children:_('Add new user',{_tags:'core'})})})]})]})]})}}),3919,[1,17,487,1170,888,891,1102,2155,1100,1103,1130,3920,2083,483]);
__d((function(g,_r,_i,_a,m,_e,d){var e=_r(d[0]);Object.defineProperty(_e,"__esModule",{value:!0}),_e.default=void 0;var t=(function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=f(t);if(r&&r.has(e))return r.get(e);var l={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var o=n?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(l,a,o):l[a]=e[a]}return l.default=e,r&&r.set(e,l),l})(_r(d[1])),r=e(_r(d[2])),l=e(_r(d[3])),n=_r(d[4]),a=_r(d[5]),o=_r(d[6]),s=_r(d[7]),i=_r(d[8]),c=_r(d[9]),u=_r(d[10]),p=_r(d[11]);function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(f=function(e){return e?r:t})(e)}_e.default=({site:e,wpUser:f})=>{const{login:h}=(0,c.useAppState)(),[v,j]=t.useState(!1),x=(0,n.useObservableSuspense)(f.populateResource('stores')),y=(0,u.useT)(),_=t.useCallback((async t=>{t||i.Toast.show({type:'error',text1:y('No store selected',{_tags:'core'})}),h({siteID:e.uuid,wpCredentialsID:f.uuid,storeID:t})}),[h,e.uuid,y,f.uuid]),D=t.useCallback((async()=>{try{await f.remove(),await e.incrementalUpdate({$pullAll:{wp_credentials:[f.uuid]}})}catch(e){throw e}}),[f,e]);return(0,p.jsxs)(r.default,{children:[x.length>1?(0,p.jsxs)(s.Select,{onValueChange:({value:e})=>_(e),children:[(0,p.jsx)(s.SelectPrimitiveTrigger,{asChild:!0,children:(0,p.jsx)(o.ButtonPill,{size:"xs",removable:!0,onRemove:()=>j(!0),children:(0,p.jsx)(o.ButtonText,{children:f.display_name?f.display_name:'No name?'})})}),(0,p.jsx)(s.SelectContent,{children:x.map((e=>(0,p.jsx)(s.SelectItem,{label:e.name,value:e.localID},e.localID)))})]}):(0,p.jsx)(o.ButtonPill,{size:"xs",onPress:()=>{const e=(0,l.default)(x,[0,'localID']);_(e)},removable:!0,onRemove:()=>j(!0),children:(0,p.jsx)(o.ButtonText,{children:f.display_name?f.display_name:'No name?'})}),(0,p.jsx)(a.AlertDialog,{open:v,onOpenChange:j,children:(0,p.jsxs)(a.AlertDialogContent,{children:[(0,p.jsxs)(a.AlertDialogHeader,{children:[(0,p.jsx)(a.AlertDialogTitle,{children:y('Remove {name}',{name:f.display_name,_tags:'core'})}),(0,p.jsx)(a.AlertDialogDescription,{children:y('Are you sure you want to remove this user? Removing a user from the POS will not effect any data on the server.',{_tags:'core'})})]}),(0,p.jsxs)(a.AlertDialogFooter,{children:[(0,p.jsx)(a.AlertDialogCancel,{children:y('Cancel',{_tags:'core'})}),(0,p.jsx)(a.AlertDialogAction,{variant:"destructive",onPress:D,children:y('Remove',{_tags:'core'})})]})]})})]})}}),3920,[1,17,320,899,1170,3576,1167,3300,1139,1168,2083,483]);
__d((function(g,_r,_i,_a,m,_e,d){var e=_r(d[0]);Object.defineProperty(_e,"__esModule",{value:!0}),_e.default=function(){const{onConnect:e,loading:p,error:y}=(0,i.default)(),[_,b]=t.useState(''),j=(0,c.useT)();return t.useEffect((()=>{y&&l.Toast.show({type:'error',text1:j('{message}',{_tags:'core',message:y||'Error'})})}),[y,j]),(0,f.jsxs)(s.VStack,{children:[(0,f.jsx)(u.Label,{nativeID:"woo-store",children:j('Enter the URL of your WooCommerce store',{_tags:'core'})+':'}),(0,f.jsxs)(o.HStack,{children:[(0,f.jsx)(a.Input,{"aria-labelledby":"woo-store",type:"url",value:_,onChangeText:b,onSubmitEditing:()=>e(_),clearable:!0,className:"flex-1"}),(0,f.jsx)(n.Button,{onPress:()=>e(_),disabled:(0,r.default)(_),loading:p,children:(0,f.jsx)(n.ButtonText,{children:j('Connect',{_tags:'core'})})})]})]})};var t=(function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=p(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var u=o?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n})(_r(d[1])),r=e(_r(d[2])),n=_r(d[3]),o=_r(d[4]),a=_r(d[5]),u=_r(d[6]),l=_r(d[7]),s=_r(d[8]),c=_r(d[9]),i=e(_r(d[10])),f=_r(d[11]);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(p=function(e){return e?r:t})(e)}}),3921,[1,17,1908,1167,891,3299,3279,1139,1130,2083,3916,483]);
__d((function(g,r,i,a,m,e,d){var n=r(d[0]);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=n(r(d[1]));const o=Object.assign({},t.default,{isElectron:void 0,isStandalone:window.navigator.standalone});e.default=o}),3922,[1,86]);
__d((function(g,_r,_i,_a,m,_e,d){var e=_r(d[0]);Object.defineProperty(_e,"__esModule",{value:!0}),_e.default=void 0;var t=(function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var a=f(t);if(a&&a.has(e))return a.get(e);var n={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var l=r?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(n,i,l):n[i]=e[i]}return n.default=e,a&&a.set(e,n),n})(_r(d[1])),a=_r(d[2]),n=e(_r(d[3])),r=_r(d[4]),i=_r(d[5]),l=_r(d[6]),s=e(_r(d[7])),o=_r(d[8]),c=_r(d[9]),u=_r(d[10]);function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(f=function(e){return e?a:t})(e)}_e.default=({route:e})=>{const{siteID:f}=e.params,{user:p,userDB:w}=(0,o.useAppState)(),_=(0,r.useObservableSuspense)(p.populateResource('sites')),h=(0,a.useNavigation)(),y=_.find((e=>e.uuid===f)),j=(0,c.useT)();if(!y)throw new Error('Site not found');const v=t.useCallback((async e=>{const t=(0,n.default)(e,'uuid'),a=(0,n.default)(e,'jwt');try{const n=await w.wp_credentials.findOneFix(t).exec();if(n){await n.incrementalPatch({jwt:a});y.wp_credentials.find((e=>e===t))||await y.getLatest().incrementalPatch({wp_credentials:[...y.wp_credentials,t]})}else await w.wp_credentials.insert(e),await y.getLatest().incrementalPatch({wp_credentials:[...y.wp_credentials,t]})}catch(e){s.default.error(e)}finally{h.goBack()}}),[h,y,w.wp_credentials]);return(0,u.jsx)(i.Modal,{children:(0,u.jsxs)(i.ModalContent,{children:[(0,u.jsx)(i.ModalHeader,{children:(0,u.jsx)(i.ModalTitle,{children:j('Login',{_tags:'core'})})}),(0,u.jsx)(i.ModalBody,{children:(0,u.jsx)(l.WebView,{src:`${y.home}/wcpos-login`,style:{height:'500px'},onMessage:e=>{const t=(0,n.default)(e,'data.action'),a=(0,n.default)(e,'data.payload');'wcpos-wp-credentials'===t&&v(a)}})})]})})}}),3923,[1,17,487,899,1170,2388,3433,1767,1168,2083,483]);